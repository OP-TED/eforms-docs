= eForms Preview environment

== Scope and purpose

The Publications Office (OP) is developing a range of applications for the collection, validation, processing, visualisation and dissemination of eForms notices. These applications are collectively known as "TED Apps for eForms" and are scheduled to go into production use on November 14, 2022. 

To allow early access to these applications before they are deployed in production, we have prepared an additional "preview" environment for eSenders and stakeholders, where we progressively deploy early versions of the TED Apps for eForms as they become available.

The application features, URLs as well as the data present in the "preview" environment, are subject to unannounced changes until the go-live deadline is reached in November 2022. 

CAUTION: For accessing the web applications in the "preview" environment (eNotices2 and the TED Developer Portal), you need an EU-Login acceptance environment account which you can get at https://ecas.acceptance.ec.europa.eu/cas. To access eNotices2 API in Preview, you would need to generate a key from the TED Developer Portal in Preview: https://developer.preview.ted.europa.eu/home

== TED Apps for eForms

The TED applications for eForms are: 

eNotices2:: eNotices2 is the reception system for eForms. Notices can be submitted and managed through the web front-end or via the TED API. eNotices2 replaces the current eNotices and eSentool applications. eNotices2 calls the Central Validation Service to validate submitted notices before sending them to TED Monitor for processing and eventual publication.

TED Central Validation Service:: 
The Central Validation Service (a.k.a. TED CVS) provides an API for validating eForms notices. It is called by eNotices2 to check the validity of a submitted notice, but it can also be called by eSender applications to validate a notice at any time.

TED Viewer:: 
Also known as "TED Viewer 2022" this notice visualisation service provides an API that allows applications to render an eForms notice in the HTML or PDF format.

TED Developer Portal::
The TED Developer Portal is envisioned to be a central hub for TED developer services. At this point in time, the portal allows eSenders to sign-up and obtain/manage their API key which is required for calling TED APIs.


TED Monitor::
Also known as "TED Monitor 2022", this application is the internal production system used by OP to prepare the publication in the Supplement of the Official Journal (hosted in the TED website) of the public procurement notices submitted every day. It also allows OP to check the lawfulness of certain notices and to mask unpublished fields. 
+
NOTE: TED Monitor is not accessible by eSenders in the "preview" environment.

TED Website:: 
TED is the public dissemination website for European procurement notices. It is the digital (and only) form of the Supplement to the Official Journal of the EU (OJ S). The current TED website, which is being adapted to handle eForms notices, is scheduled to be replaced by a totally new, built-from-scratch version (a.k.a. TED 2.0), in Spring of 2023. 
+
NOTE: The TED website is not available in the "preview" environment

image::systems-diagram.png[]

== Accessing TED Apps in PREVIEW

===  eNotices2

Website:: https://enotices2.preview.ted.europa.eu

API documentation:: https://enotices2.preview.ted.europa.eu/esenders/swagger-ui/

CAUTION: The URLs and parameters may change in subsequent releases.

WARNING: Please be aware that the interface and the notice forms are very much a work in progress in this release. 

==== Currently available
[horizontal] 
Application version:: 1.3.2
SDK version:: 1.3.2


In this version, the application is expected to allow users to create the 40 eForms notice types plus the 5 other notice types which include the 2 transport regulation notices, the European economic interest grouping and European company/cooperative registration forms, and the call for expression of interest. The fields which are available, along with their behaviour, are consistent with SDK 1.3. In the codelist fields, prefilling of values is supported.  

Users can see the validation returned from CVS and have their notices rendered in HTML and PDF.

Before you can create a Change notice or continue a procedure on a published notice, bear in mind that submitted notices go through another workflow in TED Monitor before they can be published, which takes place every working day.  

The application also allows users to act upon notices and procedures, archiving, renaming and transferring them to other users or other procedures as well as export notices in XML.  

There is also a search feature which allows users to sort through long lists of procedures.  

Users can create workgroups between themselves and test the definitions of roles and permissions within these workgroups. They can also work and submit notices worked upon collectively. 

Users can also define personalised settings for the legal basis and notice types that they want to use, as well as default languages in the notice, and tailoring of some fields is available: 

* Optional fields can be set to mandatory or hidden, however, please note that we have removed the Conditional rules as of SDK 1.3 – for these please leave the default behaviour.

* Confidential fields can be set to be always confidential or non-confidential.  

* To get started, please fill in Organisation Name, Organisation Identifier and Oganisation Part Name under My Form Settings > Main Buyer Settings. 

In the notice sections a search feature has been added and pagination for up to 2000 lots is supported. 


==== Known issues 
At this point, the application is incomplete and many use cases are not fully implemented, e.g. the "import a notice" function is currently disabled. 

All validation errors are currently displayed as a pop-up window, without pointing to the error location. Please set a default currency to avoid validation errors in the notices created in the user interface that can lead to a message that the: “notice is probably incomplete”.

All the error messages and labels in the user interface (UI), notices and fields are subject to change – translation of labels is still work in progress. 

Regarding the Main Buyer, apart from the Organisation Name, Organisation Identifier and Organisation Part Name, the rest of My Form Settings is currently not fully implemented and this function should not be used. Should you set a default place of performance under My forms settings > Default values, please pay attention not to use "place of performance other" at the same time in the form-filling tool. 

Currently, Touchpoints and Groups of Lots cannot be deleted once created.

Notices go through CVS validation when they are submitted, or when the user clicks on validate in the user interface, however, the feature may be unstable.

Result notices cannot be successfully validated/ submitted through the user interface.

For the moment, CVS validation does not work dynamically, i.e. there is no check between notices. This has implications, e.g. for checking notices of the same procedure or the same UUID v4 and different version ID; currently it is possible to submit and publish two notices that carry the same notice ID and different version IDs. See in contrast: https://docs.ted.europa.eu/eforms/latest/schema/elements.html#noticeIDSection.

For the moment, it is not possible to link a TED Schema notice to an eForms notice via the Previous Notice (OPP-090) as described in the documentation: https://docs.ted.europa.eu/eforms/latest/schema/elements.html#previousNoticeSection.
    
eNotices2 uses the codelists from the SDK, which have not been completely tailored. 

The eNotices2 API URLs and parameters will change in later releases. The link:https://enotices2.preview.ted.europa.eu/esenders/swagger-ui/[Swagger UI] provides basic documentation of the four functions.

   * POST submit XML request should return a "cvsLink", which currently does not link to the CVS report. 
   * Notices that trigger a lawfulness warning, will currently be submitted to eNotices2 with “VALIDATION_FAILED”. 



==== Tips for using the form-filling tool of eNotices2

We are currently in the process of providing more guidance for users of the eNotices2 web interface. In recent weeks we have loosened many rules that required fields to be mandatory under certain conditions, which makes it easier to fill in the forms.  However, as certain co-constraints and conditional rules have been removed, the same is not true for CVS validation upon validating a notice or trying to submit it via the user interface of eNotices2. Until we can provide some more guidance and until known issues are fixed and more rules are re-enforced, we have provisionally gathered here some tips to help users with avoiding validation errors: 

   * BT-747 Selection criteria must be entered 3 times using the 3 values from the codelist (except none). 
   * In multi-stage procedures (BT-105), the second stage indicator should be set to 'yes' on one of those 3 groups where the criterion is used. 
   * "Award criteria complicated" should be filled-in with a variation of "See the procurement documents" to avoid having to fill in Criterion parameters.
   * Avoid repeating the award criteria group (first level).
   * In the group "information about late submission' use only one "Reserved participation (BT-71-Lot)" and leave the rest empty.
   * For Exclusion Grounds, use only once the code value and enter ”all other exclusion grounds apply" in the description; avoid repeating codelist values.
   * Group "Post Award Process" both indicators should be always set to "true".
   * Any date field which has a time attached must always have a value in the time field.
   * "Deadline until which the tender must remain valid (BT-98-Lot)" is not a date but an amount of time. 
   
   

==== Planned updates 
[horizontal]
Indicative planning:: November 2022
Application version:: 1.3.3
SDK version used:: 1.3.3

This version of the application is focused on improvements to the UI experience and the correction of bugs.



=== TED Central Validation Service 

API documentation:: https://cvs.preview.ted.europa.eu/swagger-ui/

==== Currently available 
[horizontal]
Application version:: 1.2.0
SDK versions:: 1.0.0, 1.1.1, 1.2.1, 1.3.2
Scope:: Complete implementation, including the execution of the validation rules (Schematron).

We are working on resolving the following limitations and known issues:

* Large notices (3 MB or above) cannot be sent, due to a technical restriction.
* The validation mode "dynamic" currently does not fetch information from other notices, so it is equivalent to the "static" validation mode.
* If an element that appears multiple times in the notice begin validated is mentioned in the "location" attribute of a failed assert, the position number indicated is off by one. For example, the second lot is indicated as `cac:ProcurementProjectLot[1]` but it should be `cac:ProcurementProjectLot[2]`.


=== TED Viewer

API documentation:: To come at https://viewer.preview.ted.europa.eu/swagger-ui/index.html

==== Currently available 
[horizontal]
Application version:: 1.2.2
SDK versions:: 1.3.2 
Scope:: Final version of the application with full rendering of HTML and PDF and using the view-templates defined in the SDK   

==== Planned updates
[horizontal]
Scope:: Ongoing improvements with successive SDK releases


=== TED Developer Portal

==== Currently available 
[horizontal]
Website URL:: https://developer.preview.ted.europa.eu/home 
Scope:: Users can generate an API key 

==== Planned updates
[horizontal]
Indicative planning:: December 2022
Scope:: Addition of a developer profile for eSenders



